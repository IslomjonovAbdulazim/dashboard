import{r as b,f as me,t as g,j as e,c as F,B as v,o as H,h as xe,n as U,s as B,i as he,_ as Y}from"./index-BgyDtNiv.js";import{u as ue}from"./useQuery-CgxBcApU.js";import{A as G,a as R,b as z,H as je,S as ge,T as pe,C as fe,P as be}from"./config-drawer-CPqw4M9g.js";import{T as ve,M as Ne}from"./top-nav-CV4kcU2N.js";import{l as P,g as ae}from"./media-utils-DwH0f5r5.js";import{u as D,E as Ce,S as ye,T as we,F as ne,a as x,b as h,c as u,d as j,e as p,f as re}from"./form-C5osUfP1.js";import{B as Z}from"./badge-CfInFiFo.js";import{C as M,a as E,b as A,c as O,d as I}from"./card-v1uoEE92.js";import{D as _e,e as Se,f as Le,g as Pe,i as T,h as ke,j as $,k as J,l as Q,m as W,n as K,o as V,X as De}from"./dropdown-menu-CbyZjeZg.js";import{T as Fe,a as Te,b as ee,c as w,d as Ue,e as _}from"./table-BGrjgXTT.js";import{C as Me}from"./index-Vj7zbINv.js";import{B as k,U as Ee,G as Ae,s as Oe}from"./sidebar-BuvVQDyf.js";import{U as q,I as se}from"./upload-D8YRluLw.js";import{c as te}from"./createLucideIcon-CVShTzUI.js";import{u as ie,a as le,I as f}from"./input-v00MU9y0.js";import{S as oe}from"./switch-tVXKj20j.js";import{L as X}from"./loader-circle-DPzIDlLC.js";import{P as Ie}from"./plus-BRxX29p4.js";import"./zehnly-auth-api-1g0FtGCR.js";import"./api-D_rfR1zQ.js";import"./label-DUPVReW0.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],Ge=te("toggle-left",Be);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],ze=te("toggle-right",Re);function qe({data:l,isLoading:m,onEdit:t,onUploadLogo:i,onRefresh:r}){const[o,n]=b.useState(!1),[a,d]=b.useState(null),N=me(),y=D({mutationFn:s=>P.togglePayment(s),onSuccess:s=>{g.success(s.message),N.invalidateQueries({queryKey:["learning-centers"]}),r()},onError:s=>{g.error("Failed to toggle payment status"),console.error("Toggle payment error:",s)}}),S=D({mutationFn:s=>P.deactivate(s),onSuccess:s=>{g.success(s.message),N.invalidateQueries({queryKey:["learning-centers"]}),r(),n(!1),d(null)},onError:s=>{g.error("Failed to deactivate learning center"),console.error("Delete error:",s)}}),L=s=>{y.mutate(s.id)},C=s=>{d(s),n(!0)},c=()=>{a&&S.mutate(a.id)};return m?e.jsxs(M,{children:[e.jsxs(E,{children:[e.jsx(A,{children:"Learning Centers"}),e.jsx(O,{children:"Loading..."})]}),e.jsx(I,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):l.length===0?e.jsxs(M,{children:[e.jsxs(E,{children:[e.jsx(A,{children:"Learning Centers"}),e.jsx(O,{children:"No learning centers found"})]}),e.jsx(I,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(k,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["No learning centers have been created yet.",e.jsx("br",{}),'Click "Add Learning Center" to get started.']})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(M,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(E,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-primary"}),"Learning Centers (",l.length,")"]}),e.jsx(O,{className:"mt-1",children:"Comprehensive management of educational institutions"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Active"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:l.filter(s=>s.is_active).length})]})]})}),e.jsx(I,{children:e.jsxs(Fe,{children:[e.jsx(Te,{children:e.jsxs(ee,{children:[e.jsx(w,{children:"Center"}),e.jsx(w,{children:"Contact"}),e.jsx(w,{children:"Limits"}),e.jsx(w,{children:"Status"}),e.jsx(w,{children:"Payment"}),e.jsx(w,{children:"Created"}),e.jsx(w,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(Ue,{children:l.map(s=>e.jsxs(ee,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(G,{className:"h-10 w-10",children:[e.jsx(R,{src:ae(s.logo),alt:s.name}),e.jsx(z,{children:e.jsx(k,{className:"h-4 w-4"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: ",s.id]})]})]})}),e.jsx(_,{children:e.jsx("div",{className:"text-sm",children:s.phone})}),e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ee,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.student_limit," students"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.teacher_limit," teachers"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),e.jsxs("span",{children:[s.group_limit," groups"]})]})]})}),e.jsx(_,{children:e.jsxs(Z,{variant:s.is_active?"default":"secondary",className:F("font-medium transition-all duration-200",s.is_active?"bg-emerald-100 text-emerald-700 hover:bg-emerald-200 border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-400 dark:border-emerald-800":"bg-red-100 text-red-700 hover:bg-red-200 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800"),children:[e.jsx("div",{className:F("w-2 h-2 rounded-full mr-1",s.is_active?"bg-emerald-500":"bg-red-500")}),s.is_active?"Active":"Inactive"]})}),e.jsx(_,{children:e.jsxs(Z,{variant:s.is_paid?"default":"secondary",className:F("font-medium transition-all duration-200",s.is_paid?"bg-blue-100 text-blue-700 hover:bg-blue-200 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800":"bg-amber-100 text-amber-700 hover:bg-amber-200 border-amber-200 dark:bg-amber-900/20 dark:text-amber-400 dark:border-amber-800"),children:[e.jsx("div",{className:F("w-2 h-2 rounded-full mr-1",s.is_paid?"bg-blue-500":"bg-amber-500")}),s.is_paid?"Paid Plan":"Free Plan"]})}),e.jsx(_,{children:e.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})}),e.jsx(_,{children:e.jsxs(_e,{children:[e.jsx(Se,{asChild:!0,children:e.jsxs(v,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ce,{className:"h-4 w-4"})]})}),e.jsxs(Le,{align:"end",children:[e.jsx(Pe,{children:"Actions"}),e.jsxs(T,{onClick:()=>t(s),children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(T,{onClick:()=>i(s),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Upload Logo"]}),e.jsx(ke,{}),e.jsxs(T,{onClick:()=>L(s),disabled:y.isPending,children:[s.is_paid?e.jsx(Ge,{className:"mr-2 h-4 w-4"}):e.jsx(ze,{className:"mr-2 h-4 w-4"}),s.is_paid?"Make Free":"Make Paid"]}),e.jsxs(T,{onClick:()=>C(s),className:"text-red-600",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Deactivate"]})]})]})})]},s.id))})]})})]}),e.jsx(Me,{open:o,onOpenChange:n,title:"Deactivate Learning Center",desc:`Are you sure you want to deactivate "${a?.name}"? This action cannot be undone.`,confirmText:"Deactivate",handleConfirm:c,isLoading:S.isPending})]})}const ce=H({name:B().min(2,"Name must be at least 2 characters").max(100,"Name must be less than 100 characters"),phone:B().min(10,"Phone number must be at least 10 characters").regex(/^\+?[1-9]\d{1,14}$/,"Please enter a valid phone number"),student_limit:U().min(1,"Student limit must be at least 1").max(1e4,"Student limit cannot exceed 10,000"),teacher_limit:U().min(1,"Teacher limit must be at least 1").max(1e3,"Teacher limit cannot exceed 1,000"),group_limit:U().min(1,"Group limit must be at least 1").max(1e3,"Group limit cannot exceed 1,000"),is_paid:xe()}),He=ce.partial();H({file:he(File).refine(l=>l.size<=5*1024*1024,"File size must be less than 5MB").refine(l=>["image/jpeg","image/jpg","image/png","image/webp"].includes(l.type),"Only JPEG, PNG, and WebP images are allowed")});H({name:B().optional(),is_paid:Y(["all","paid","unpaid"]).default("all"),is_active:Y(["all","active","inactive"]).default("all")});function $e({open:l,onOpenChange:m,onSuccess:t}){const i=ie({resolver:le(ce),defaultValues:{name:"",phone:"",student_limit:100,teacher_limit:10,group_limit:20,is_paid:!0}}),r=D({mutationFn:P.create,onSuccess:n=>{g.success(`Learning center "${n.name}" created successfully`),i.reset(),t()},onError:n=>{g.error("Failed to create learning center"),console.error("Create learning center error:",n)}}),o=n=>{r.mutate(n)};return e.jsx($,{open:l,onOpenChange:m,children:e.jsxs(J,{className:"max-w-md",children:[e.jsxs(Q,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-5 w-5"}),e.jsx("span",{children:"Create Learning Center"})]}),e.jsx(K,{children:"Add a new learning center to the system with specified limits and configuration."})]}),e.jsx(ne,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(o),className:"space-y-4",children:[e.jsx(x,{control:i.control,name:"name",render:({field:n})=>e.jsxs(h,{children:[e.jsx(u,{children:"Center Name"}),e.jsx(j,{children:e.jsx(f,{placeholder:"ABC Learning Center",...n})}),e.jsx(p,{})]})}),e.jsx(x,{control:i.control,name:"phone",render:({field:n})=>e.jsxs(h,{children:[e.jsx(u,{children:"Phone Number"}),e.jsx(j,{children:e.jsx(f,{placeholder:"+998901234567",...n})}),e.jsx(p,{})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(x,{control:i.control,name:"student_limit",render:({field:n})=>e.jsxs(h,{children:[e.jsx(u,{children:"Students"}),e.jsx(j,{children:e.jsx(f,{type:"number",min:1,...n,onChange:a=>n.onChange(parseInt(a.target.value))})}),e.jsx(p,{})]})}),e.jsx(x,{control:i.control,name:"teacher_limit",render:({field:n})=>e.jsxs(h,{children:[e.jsx(u,{children:"Teachers"}),e.jsx(j,{children:e.jsx(f,{type:"number",min:1,...n,onChange:a=>n.onChange(parseInt(a.target.value))})}),e.jsx(p,{})]})}),e.jsx(x,{control:i.control,name:"group_limit",render:({field:n})=>e.jsxs(h,{children:[e.jsx(u,{children:"Groups"}),e.jsx(j,{children:e.jsx(f,{type:"number",min:1,...n,onChange:a=>n.onChange(parseInt(a.target.value))})}),e.jsx(p,{})]})})]}),e.jsx(x,{control:i.control,name:"is_paid",render:({field:n})=>e.jsxs(h,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(u,{children:"Paid Subscription"}),e.jsx(re,{children:"Enable paid features for this learning center"})]}),e.jsx(j,{children:e.jsx(oe,{checked:n.value,onCheckedChange:n.onChange})})]})}),e.jsxs(V,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>m(!1),disabled:r.isPending,children:"Cancel"}),e.jsxs(v,{type:"submit",disabled:r.isPending,children:[r.isPending&&e.jsx(X,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Center"]})]})]})})]})})}function Je({open:l,onOpenChange:m,center:t,onSuccess:i}){const r=ie({resolver:le(He),defaultValues:{name:t.name,phone:t.phone,student_limit:t.student_limit,teacher_limit:t.teacher_limit,group_limit:t.group_limit,is_paid:t.is_paid}});b.useEffect(()=>{r.reset({name:t.name,phone:t.phone,student_limit:t.student_limit,teacher_limit:t.teacher_limit,group_limit:t.group_limit,is_paid:t.is_paid})},[t,r]);const o=D({mutationFn:a=>P.update(t.id,a),onSuccess:a=>{g.success(`Learning center "${a.name}" updated successfully`),i()},onError:a=>{g.error("Failed to update learning center"),console.error("Update learning center error:",a)}}),n=a=>{o.mutate(a)};return e.jsx($,{open:l,onOpenChange:m,children:e.jsxs(J,{className:"max-w-md",children:[e.jsxs(Q,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-5 w-5"}),e.jsx("span",{children:"Edit Learning Center"})]}),e.jsxs(K,{children:['Update the configuration and limits for "',t.name,'".']})]}),e.jsx(ne,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(n),className:"space-y-4",children:[e.jsx(x,{control:r.control,name:"name",render:({field:a})=>e.jsxs(h,{children:[e.jsx(u,{children:"Center Name"}),e.jsx(j,{children:e.jsx(f,{placeholder:"ABC Learning Center",...a})}),e.jsx(p,{})]})}),e.jsx(x,{control:r.control,name:"phone",render:({field:a})=>e.jsxs(h,{children:[e.jsx(u,{children:"Phone Number"}),e.jsx(j,{children:e.jsx(f,{placeholder:"+998901234567",...a})}),e.jsx(p,{})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(x,{control:r.control,name:"student_limit",render:({field:a})=>e.jsxs(h,{children:[e.jsx(u,{children:"Students"}),e.jsx(j,{children:e.jsx(f,{type:"number",min:1,...a,onChange:d=>a.onChange(parseInt(d.target.value))})}),e.jsx(p,{})]})}),e.jsx(x,{control:r.control,name:"teacher_limit",render:({field:a})=>e.jsxs(h,{children:[e.jsx(u,{children:"Teachers"}),e.jsx(j,{children:e.jsx(f,{type:"number",min:1,...a,onChange:d=>a.onChange(parseInt(d.target.value))})}),e.jsx(p,{})]})}),e.jsx(x,{control:r.control,name:"group_limit",render:({field:a})=>e.jsxs(h,{children:[e.jsx(u,{children:"Groups"}),e.jsx(j,{children:e.jsx(f,{type:"number",min:1,...a,onChange:d=>a.onChange(parseInt(d.target.value))})}),e.jsx(p,{})]})})]}),e.jsx(x,{control:r.control,name:"is_paid",render:({field:a})=>e.jsxs(h,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(u,{children:"Paid Subscription"}),e.jsx(re,{children:"Enable paid features for this learning center"})]}),e.jsx(j,{children:e.jsx(oe,{checked:a.value,onCheckedChange:a.onChange})})]})}),e.jsxs(V,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>m(!1),disabled:o.isPending,children:"Cancel"}),e.jsxs(v,{type:"submit",disabled:o.isPending,children:[o.isPending&&e.jsx(X,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Center"]})]})]})})]})})}function Qe({open:l,onOpenChange:m,center:t,onSuccess:i}){const[r,o]=b.useState(null),[n,a]=b.useState(null),d=b.useRef(null),N=D({mutationFn:c=>P.uploadLogo(t.id,c),onSuccess:c=>{g.success(c.message),o(null),a(null),i()},onError:c=>{g.error("Failed to upload logo"),console.error("Upload logo error:",c)}}),y=c=>{const s=c.target.files?.[0];if(!s)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(s.type)){g.error("Only JPEG, PNG, and WebP images are allowed");return}if(s.size>5*1024*1024){g.error("File size must be less than 5MB");return}o(s);const de=URL.createObjectURL(s);a(de)},S=()=>{r&&N.mutate(r)},L=()=>{o(null),n&&(URL.revokeObjectURL(n),a(null)),d.current&&(d.current.value="")},C=c=>{c||L(),m(c)};return e.jsx($,{open:l,onOpenChange:C,children:e.jsxs(J,{className:"max-w-md",children:[e.jsxs(Q,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-5 w-5"}),e.jsx("span",{children:"Upload Logo"})]}),e.jsxs(K,{children:['Upload a new logo for "',t.name,'". Supported formats: JPEG, PNG, WebP (max 5MB).']})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-sm font-medium",children:"Current Logo:"}),e.jsxs(G,{className:"h-12 w-12",children:[e.jsx(R,{src:ae(t.logo),alt:t.name}),e.jsx(z,{children:e.jsx(se,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-6",children:r?e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(G,{className:"h-20 w-20",children:[e.jsx(R,{src:n||void 0,alt:"Preview"}),e.jsx(z,{children:e.jsx(se,{className:"h-8 w-8"})})]}),e.jsx(v,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:L,children:e.jsx(De,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium",children:r.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[(r.size/1024/1024).toFixed(2)," MB"]})]})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("div",{className:"mt-4",children:e.jsx(v,{type:"button",variant:"outline",onClick:()=>d.current?.click(),children:"Choose File"})}),e.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"JPEG, PNG, WebP up to 5MB"})]})}),e.jsx("input",{ref:d,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:y,className:"hidden"})]}),e.jsxs(V,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>C(!1),disabled:N.isPending,children:"Cancel"}),e.jsxs(v,{type:"button",onClick:S,disabled:!r||N.isPending,children:[N.isPending&&e.jsx(X,{className:"mr-2 h-4 w-4 animate-spin"}),"Upload Logo"]})]})]})})}function We(){const[l,m]=b.useState(!1),[t,i]=b.useState(!1),[r,o]=b.useState(!1),[n,a]=b.useState(null),{data:d=[],isLoading:N,refetch:y}=ue({queryKey:["learning-centers"],queryFn:()=>P.list({limit:100})}),S=c=>{a(c),i(!0)},L=c=>{a(c),o(!0)},C=()=>{y(),m(!1),i(!1),o(!1),a(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsx(ve,{links:Ke}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(ge,{}),e.jsx(pe,{}),e.jsx(fe,{}),e.jsx(be,{})]})]}),e.jsxs(Ne,{children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Learning Centers"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Manage all learning centers, their configurations, and operational limits"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(v,{onClick:()=>m(!0),size:"lg",className:"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary/80 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx(Ie,{className:"mr-2 h-5 w-5"}),"Add Learning Center"]})})]}),e.jsx(qe,{data:d,isLoading:N,onEdit:S,onUploadLogo:L,onRefresh:y})]}),e.jsx($e,{open:l,onOpenChange:m,onSuccess:C}),n&&e.jsxs(e.Fragment,{children:[e.jsx(Je,{open:t,onOpenChange:i,center:n,onSuccess:C}),e.jsx(Qe,{open:r,onOpenChange:o,center:n,onSuccess:C})]})]})}const Ke=[{title:"Overview",href:"/learning-centers",isActive:!0,disabled:!1},{title:"Analytics",href:"/learning-centers/analytics",isActive:!1,disabled:!0},{title:"Settings",href:"/learning-centers/settings",isActive:!1,disabled:!0}],ps=We;export{ps as component};

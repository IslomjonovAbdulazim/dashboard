import{r as b,f as R,j as e,B as N,t as u,o as $,n as B,_ as H,s as S}from"./index-B9ijFU24.js";import{u as T,T as ge,M as fe}from"./top-nav-U0iLahR3.js";import{H as ye,S as ve,T as be,C as Ne,P as we}from"./config-drawer-CrK8Q9VY.js";import{c as X,b as w}from"./createLucideIcon-DuWw8G0_.js";import{C as U,a as E,b as P,c as q,d as O}from"./card-CG-QEZA1.js";import{U as V,M as Ce,D as Se,j as _e,k as Ae,l as De,m as z,n as L,A as G,s as J,t as Y,N as Z,O as ee,Q as se,R as ne,T as ae,V as Fe,W as re}from"./sign-out-dialog-CHzf-qJM.js";import{T as ke,a as Me,b as te,c as A,d as Te,e as D}from"./table-C6TmOk5Z.js";import{u as F,E as Ue,S as I,T as Ee,g as ie,l as Q,F as le,a as j,b as g,c as f,d as y,e as v,f as k}from"./form-CsvHarOm.js";import{P as Pe}from"./phone-Buzrv1l4.js";import{f as qe}from"./format-Dp3w_Y3x.js";import{U as Oe,a as K}from"./user-plus-B9iMwsci.js";import{u as ce,a as de,I as M}from"./label-BAGal0tM.js";import{S as oe,a as me,b as xe,c as he,d as ue}from"./select-CEfwOxyw.js";import{B as C}from"./badge-D2S1lwUw.js";import{L as pe}from"./loader-circle-Ci-a50VE.js";import"./chevron-down-DQBvPwlq.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],W=X("building",Le);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Ke=X("user-x",Ie),_={list:async s=>{const t=new URLSearchParams;return s?.learning_center_id!==void 0&&t.set("learning_center_id",s.learning_center_id.toString()),s?.role!==void 0&&t.set("role",s.role),s?.skip!==void 0&&t.set("skip",s.skip.toString()),s?.limit!==void 0&&t.set("limit",s.limit.toString()),(await w.get(`/api/v1/super-admin/users?${t.toString()}`)).data},get:async s=>(await w.get(`/api/v1/super-admin/users/${s}`)).data,create:async s=>(await w.post("/api/v1/super-admin/users",s)).data,update:async(s,t)=>(await w.put(`/api/v1/super-admin/users/${s}`,t)).data,delete:async s=>(await w.delete(`/api/v1/super-admin/users/${s}`)).data};function Re({data:s,isLoading:t,onEdit:n,onRefresh:l}){const[c,m]=b.useState(!1),[x,o]=b.useState(null),d=R(),p=F({mutationFn:r=>_.delete(r),onSuccess:()=>{u.success("User deleted successfully"),d.invalidateQueries({queryKey:["users"]}),l(),m(!1),o(null)},onError:r=>{u.error(r.response?.data?.detail||"Failed to delete user")}}),h=F({mutationFn:({id:r,is_active:je})=>_.update(r,{is_active:!je}),onSuccess:()=>{u.success("User status updated successfully"),d.invalidateQueries({queryKey:["users"]}),l()},onError:r=>{u.error(r.response?.data?.detail||"Failed to update user status")}}),i=r=>{o(r),m(!0)},a=r=>{h.mutate({id:r.id,is_active:r.is_active})};return t?e.jsxs(U,{children:[e.jsxs(E,{children:[e.jsx(P,{children:"Admins"}),e.jsx(q,{children:"Loading..."})]}),e.jsx(O,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):s.length===0?e.jsxs(U,{children:[e.jsxs(E,{children:[e.jsx(P,{children:"Admins"}),e.jsx(q,{children:"No admins found"})]}),e.jsx(O,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(V,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground text-center",children:["No admins have been created yet.",e.jsx("br",{}),'Click "Add Admin" to get started.']})]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(U,{className:"border-0 shadow-lg bg-gradient-to-br from-card via-card to-card/95",children:[e.jsx(E,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(P,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-primary"}),"Admins (",s.length,")"]}),e.jsx(q,{className:"mt-1",children:"Manage admin users and their access permissions"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Admins"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:s.filter(r=>r.is_active).length})]})]})}),e.jsx(O,{children:e.jsxs(ke,{children:[e.jsx(Me,{children:e.jsxs(te,{children:[e.jsx(A,{children:"Admin"}),e.jsx(A,{children:"Learning Center"}),e.jsx(A,{children:"Created"}),e.jsx(A,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(Te,{children:s.map(r=>e.jsx($e,{user:r,onEdit:n,onToggleActive:a,onDelete:i},r.id))})]})})]}),e.jsx(Ce,{open:c,onOpenChange:m,handleConfirm:()=>x&&p.mutate(x.id),title:"Delete Admin",desc:`Are you sure you want to delete ${x?.name}? This action cannot be undone.`,confirmText:"Delete Admin",isLoading:p.isPending,destructive:!0})]})}function $e({user:s,onEdit:t,onToggleActive:n,onDelete:l}){return e.jsxs(te,{children:[e.jsx(D,{className:"max-w-[300px]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-r from-primary/20 to-primary/10 border border-primary/20",children:e.jsx("span",{className:"text-sm font-medium text-primary",children:s.name.split(" ").map(c=>c[0]).join("").toUpperCase()})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Pe,{className:"mr-1 h-3 w-3"}),e.jsx("span",{className:"truncate",children:s.phone})]})]})]})}),e.jsx(Be,{learningCenterId:s.learning_center_id}),e.jsx(D,{children:e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:qe(new Date(s.created_at),"MMM dd, yyyy")})}),e.jsx(D,{children:e.jsxs(Se,{children:[e.jsx(_e,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ue,{className:"h-4 w-4"})]})}),e.jsxs(Ae,{align:"end",children:[e.jsx(De,{children:"Actions"}),e.jsx(z,{}),e.jsxs(L,{onClick:()=>t(s),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(L,{onClick:()=>n(s),children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"mr-2 h-4 w-4"}),"Activate"]})}),e.jsx(z,{}),e.jsxs(L,{onClick:()=>l(s),className:"text-red-600",children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},s.id)}function Be({learningCenterId:s}){const{data:t=[]}=T({queryKey:["learning-centers"],queryFn:()=>Q.list()}),n=t.find(l=>l.id===s);return e.jsx(D,{className:"max-w-[200px]",children:n?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(G,{className:"h-8 w-8",children:[e.jsx(J,{src:ie(n.logo||null),alt:n.name}),e.jsx(Y,{children:e.jsx(W,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-sm truncate",title:n.name,children:n.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: ",n.id]})]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsxs("span",{children:["Center #",s]})]})})}const He=$({name:S().min(2,"Name must be at least 2 characters").max(100,"Name must be less than 100 characters"),phone:S().min(10,"Phone number must be at least 10 characters").regex(/^\+?[1-9]\d{1,14}$/,"Please enter a valid phone number"),role:H(["admin","teacher","student"],{message:"Please select a role"}),learning_center_id:B().min(1,"Please select a learning center")}),Qe=$({name:S().min(2,"Name must be at least 2 characters").max(100,"Name must be less than 100 characters").optional(),phone:S().min(10,"Phone number must be at least 10 characters").regex(/^\+?[1-9]\d{1,14}$/,"Please enter a valid phone number").optional(),role:H(["admin","teacher","student"]).optional(),learning_center_id:B().min(1,"Please select a learning center").optional()});$({role:H(["all","admin","teacher","student"]).default("all"),learning_center_id:B().optional(),search:S().optional()});const Ve={admin:{label:"Admin",color:"purple",description:"Full access to learning center management"},teacher:{label:"Teacher",color:"blue",description:"Manage classes, students, and content"},student:{label:"Student",color:"green",description:"Access learning materials and courses"}};function ze({open:s,onOpenChange:t,onSuccess:n}){const[l,c]=b.useState(!1),m=R(),{data:x=[]}=T({queryKey:["learning-centers"],queryFn:()=>Q.list()}),o=ce({resolver:de(He),defaultValues:{name:"",phone:"",role:"admin",learning_center_id:1}}),d=F({mutationFn:i=>_.create(i),onSuccess:()=>{u.success("User created successfully"),m.invalidateQueries({queryKey:["users"]}),o.reset(),n()},onError:i=>{u.error(i.response?.data?.detail||"Failed to create user")},onSettled:()=>{c(!1)}}),p=async i=>{c(!0),d.mutate(i)},h=i=>{l||(t(i),i||o.reset())};return e.jsx(Z,{open:s,onOpenChange:h,children:e.jsxs(ee,{className:"sm:max-w-[500px]",children:[e.jsxs(se,{children:[e.jsxs(ne,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-r from-primary/20 to-primary/10 border border-primary/20",children:e.jsx(K,{className:"h-5 w-5 text-primary"})}),"Create New Admin"]}),e.jsx(ae,{children:"Add a new admin to a learning center. They will have full access to manage their learning center."})]}),e.jsx(le,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(p),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(j,{control:o.control,name:"name",render:({field:i})=>e.jsxs(g,{children:[e.jsx(f,{children:"Full Name"}),e.jsx(y,{children:e.jsx(M,{placeholder:"Enter full name",...i,disabled:l})}),e.jsx(v,{})]})}),e.jsx(j,{control:o.control,name:"phone",render:({field:i})=>e.jsxs(g,{children:[e.jsx(f,{children:"Phone Number"}),e.jsx(y,{children:e.jsx(M,{placeholder:"+998901234567",...i,disabled:l})}),e.jsx(k,{children:"Enter phone number with country code (e.g., +998901234567)"}),e.jsx(v,{})]})}),e.jsx(j,{control:o.control,name:"role",render:({})=>e.jsxs(g,{children:[e.jsx(f,{children:"Role"}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border bg-muted/30 p-3",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",children:e.jsx(K,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:"Admin"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Full access to learning center management"})]}),e.jsx(C,{variant:"default",className:"bg-primary/10 text-primary hover:bg-primary/20",children:"Selected"})]})}),e.jsx(v,{})]})}),e.jsx(j,{control:o.control,name:"learning_center_id",render:({field:i})=>e.jsxs(g,{children:[e.jsx(f,{children:"Learning Center"}),e.jsxs(oe,{onValueChange:a=>i.onChange(parseInt(a)),defaultValue:i.value?.toString(),disabled:l,children:[e.jsx(y,{children:e.jsx(me,{children:e.jsx(xe,{placeholder:"Select a learning center"})})}),e.jsx(he,{children:x.map(a=>e.jsx(ue,{value:a.id.toString(),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(G,{className:"h-6 w-6",children:[e.jsx(J,{src:ie(a.logo),alt:a.name}),e.jsx(Y,{children:e.jsx(Fe,{className:"h-3 w-3"})})]}),e.jsx("span",{children:a.name}),e.jsx(C,{variant:a.is_active?"default":"secondary",className:"ml-auto text-xs",children:a.is_active?"Active":"Inactive"})]})},a.id))})]}),e.jsx(k,{children:"Select the learning center this admin will manage"}),e.jsx(v,{})]})})]}),e.jsxs(re,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>h(!1),disabled:l,children:"Cancel"}),e.jsxs(N,{type:"submit",disabled:l,className:"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary/80",children:[l&&e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Admin"]})]})]})})]})})}function We({open:s,onOpenChange:t,user:n,onSuccess:l}){const[c,m]=b.useState(!1),x=R(),{data:o=[]}=T({queryKey:["learning-centers"],queryFn:()=>Q.list()}),d=ce({resolver:de(Qe),defaultValues:{name:n.name,phone:n.phone,role:n.role,learning_center_id:n.learning_center_id}});b.useEffect(()=>{n&&d.reset({name:n.name,phone:n.phone,role:n.role,learning_center_id:n.learning_center_id})},[n,d]);const p=F({mutationFn:a=>_.update(n.id,a),onSuccess:()=>{u.success("Admin updated successfully"),x.invalidateQueries({queryKey:["users"]}),l()},onError:a=>{u.error(a.response?.data?.detail||"Failed to update admin")},onSettled:()=>{m(!1)}}),h=async a=>{const r={};if(a.name!==n.name&&(r.name=a.name),a.phone!==n.phone&&(r.phone=a.phone),a.role!==n.role&&(r.role=a.role),a.learning_center_id!==n.learning_center_id&&(r.learning_center_id=a.learning_center_id),Object.keys(r).length===0){u.info("No changes detected"),l();return}m(!0),p.mutate(r)},i=a=>{c||t(a)};return e.jsx(Z,{open:s,onOpenChange:i,children:e.jsxs(ee,{className:"sm:max-w-[500px]",children:[e.jsxs(se,{children:[e.jsxs(ne,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-r from-primary/20 to-primary/10 border border-primary/20",children:e.jsx(I,{className:"h-5 w-5 text-primary"})}),"Edit Admin"]}),e.jsx(ae,{children:"Update admin information and learning center assignment. Changes will be reflected immediately."})]}),e.jsx(le,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(h),className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx("div",{className:"rounded-lg bg-muted/50 p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-r from-primary/20 to-primary/10 border border-primary/20",children:e.jsx("span",{className:"text-sm font-medium text-primary",children:n.name.split(" ").map(a=>a[0]).join("").toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:n.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:n.phone})]}),e.jsx(C,{className:"ml-auto",children:Ve[n.role].label})]})}),e.jsx(j,{control:d.control,name:"name",render:({field:a})=>e.jsxs(g,{children:[e.jsx(f,{children:"Full Name"}),e.jsx(y,{children:e.jsx(M,{placeholder:"Enter full name",...a,disabled:c})}),e.jsx(v,{})]})}),e.jsx(j,{control:d.control,name:"phone",render:({field:a})=>e.jsxs(g,{children:[e.jsx(f,{children:"Phone Number"}),e.jsx(y,{children:e.jsx(M,{placeholder:"+998901234567",...a,disabled:c})}),e.jsx(k,{children:"Enter phone number with country code (e.g., +998901234567)"}),e.jsx(v,{})]})}),e.jsx(j,{control:d.control,name:"role",render:({})=>e.jsxs(g,{children:[e.jsx(f,{children:"Role"}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border bg-muted/30 p-3",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",children:e.jsx(I,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:"Admin"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Full access to learning center management"})]}),e.jsx(C,{variant:"default",className:"bg-primary/10 text-primary hover:bg-primary/20",children:"Fixed"})]})}),e.jsx(v,{})]})}),e.jsx(j,{control:d.control,name:"learning_center_id",render:({field:a})=>e.jsxs(g,{children:[e.jsx(f,{children:"Learning Center"}),e.jsxs(oe,{onValueChange:r=>a.onChange(parseInt(r)),value:a.value?.toString(),disabled:c,children:[e.jsx(y,{children:e.jsx(me,{children:e.jsx(xe,{placeholder:"Select a learning center"})})}),e.jsx(he,{children:o.map(r=>e.jsx(ue,{value:r.id.toString(),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:r.name}),e.jsx(C,{variant:r.is_active?"default":"secondary",className:"ml-2 text-xs",children:r.is_active?"Active":"Inactive"})]})},r.id))})]}),e.jsx(k,{children:"Select the learning center this admin will manage"}),e.jsx(v,{})]})})]}),e.jsxs(re,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>i(!1),disabled:c,children:"Cancel"}),e.jsxs(N,{type:"submit",disabled:c,className:"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary/80",children:[c&&e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Admin"]})]})]})})]})})}function Xe(){const[s,t]=b.useState(!1),[n,l]=b.useState(!1),[c,m]=b.useState(null),{data:x=[],isLoading:o,refetch:d}=T({queryKey:["users"],queryFn:()=>_.list({role:"admin",limit:100})}),p=i=>{m(i),l(!0)},h=()=>{d(),t(!1),l(!1),m(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{children:[e.jsx(ge,{links:Ge}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(ve,{}),e.jsx(be,{}),e.jsx(Ne,{}),e.jsx(we,{})]})]}),e.jsxs(fe,{children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Admins"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Create and manage admin accounts across all learning centers"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(N,{onClick:()=>t(!0),size:"lg",className:"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary/80 shadow-lg hover:shadow-xl transition-all duration-200",children:[e.jsx(K,{className:"mr-2 h-5 w-5"}),"Add Admin"]})})]}),e.jsx(Re,{data:x,isLoading:o,onEdit:p,onRefresh:d})]}),e.jsx(ze,{open:s,onOpenChange:t,onSuccess:h}),c&&e.jsx(We,{open:n,onOpenChange:l,user:c,onSuccess:h})]})}const Ge=[{title:"Overview",href:"/user-management",isActive:!0,disabled:!1},{title:"Roles & Permissions",href:"/user-management/roles",isActive:!1,disabled:!0},{title:"Activity Log",href:"/user-management/activity",isActive:!1,disabled:!0}],hs=Xe;export{hs as component};

import{r as o,j as e,B as j,c as X}from"./index-DS6hhyNw.js";import{u as G,T as V,M as z}from"./top-nav-me_NpS-X.js";import{C as w,a as C,b as P,d as D}from"./card-DCqdEhtT.js";import{B as S}from"./badge-BFrVIDTw.js";import{e as K,s as Q,C as Z,a as J,T as W,b as Y}from"./analytics-api-Bb6Ytu3g.js";import{P as ee,a as se,b as te}from"./popover-B203ZlKB.js";import{S as ae,a as re,b as ne,c as le,d}from"./select-BTL1KyGH.js";import{T as ie,a as de,b as k,c as r,d as ce,e as n}from"./table-BpfNNWah.js";import{H as me,S as oe,T as xe,c as ue,P as he}from"./config-drawer-B0jE1_Lg.js";import{C as je}from"./calendar-BR9px-UY.js";import{N as p,C as fe}from"./dropdown-menu-CtmXxfDH.js";import{c as f}from"./createLucideIcon-KVZHH2n9.js";import{P as pe}from"./phone-CElyVH9a.js";import{C as E,a as T}from"./circle-x-Cw7h6vA7.js";import{f as x}from"./format-Dp3w_Y3x.js";import"./chevron-down-CZktIKOB.js";import"./zehnly-auth-api-CRg3fTmI.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ge=f("circle-alert",Ne);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],N=f("clock",ye);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],be=f("dollar-sign",ve);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ce=f("mail",we);function Pe(){const[a,I]=o.useState({from:Q(new Date),to:K(new Date)}),[u,M]=o.useState("all"),[O,g]=o.useState(!1),[i,h]=o.useState(0),[l]=o.useState(10),y=x(a.from,"yyyy-MM-dd"),v=x(a.to,"yyyy-MM-dd"),{data:t,isLoading:c,refetch:A}=G({queryKey:["orders",u,y,v,i,l],queryFn:()=>Y.getOrders({status:u==="all"?void 0:u,startDate:y,endDate:v,limit:l,skip:i*l})}),L=s=>new Intl.NumberFormat("en-US").format(s),m=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"UZS",minimumFractionDigits:0}).format(s),R=s=>{switch(s){case"PAID":return e.jsx(E,{className:"h-4 w-4 text-green-500"});case"PENDING":return e.jsx(N,{className:"h-4 w-4 text-yellow-500"});case"CANCELED":case"EXPIRED":return e.jsx(T,{className:"h-4 w-4 text-red-500"});case"TIMEOUT":return e.jsx(ge,{className:"h-4 w-4 text-orange-500"});default:return e.jsx(N,{className:"h-4 w-4 text-gray-500"})}},B=s=>{switch(s){case"PAID":return"default";case"PENDING":return"secondary";case"CANCELED":case"EXPIRED":return"destructive";case"TIMEOUT":return"outline";default:return"outline"}},H=()=>{A()},U=s=>{I(s),h(0)},_=()=>{h(s=>Math.max(0,s-1))},F=()=>{t?.data.pagination?.hasMore&&h(s=>s+1)},b=s=>s.fullName?s.fullName:s.firstName?s.firstName:s.displayName?s.displayName:s.email?s.email.split("@")[0]:s.phone?s.phone:`Order ${s.orderId.slice(-6)}`,q=s=>{M(s),h(0)};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{children:[e.jsx(V,{links:De}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(oe,{}),e.jsx(xe,{}),e.jsx(ue,{}),e.jsx(he,{})]})]}),e.jsxs(z,{children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Payments & Subscriptions"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Monitor premium subscriptions and payment transactions"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(ee,{open:O,onOpenChange:g,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:X("w-[300px] justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),a?`${x(a.from,"LLL dd, y")} - ${x(a.to,"LLL dd, y")}`:"Pick a date range"]})}),e.jsx(te,{className:"w-auto p-0",align:"start",children:e.jsx(Z,{initialFocus:!0,mode:"range",defaultMonth:a?.from,selected:a,onSelect:s=>{s?.from&&s?.to&&(U({from:s.from,to:s.to}),g(!1))},numberOfMonths:2})})]}),e.jsx(j,{onClick:H,variant:"outline",disabled:c,children:c?"Refreshing...":"Refresh"})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-1 mb-6",children:e.jsxs(w,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(P,{className:"text-sm font-medium",children:"Total Orders"}),e.jsx(p,{className:"h-4 w-4 text-orange-500"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:L(t?.data.total||0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In selected range"})]})]})}),e.jsxs(w,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Payment Orders"]}),t?.data.total&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.data.total," total orders"]})]}),e.jsxs(ae,{value:u,onValueChange:q,children:[e.jsx(re,{className:"w-[150px]",children:e.jsx(ne,{placeholder:"Filter by status"})}),e.jsxs(le,{children:[e.jsx(d,{value:"all",children:"All Orders"}),e.jsx(d,{value:"PENDING",children:"Pending"}),e.jsx(d,{value:"PAID",children:"Paid"}),e.jsx(d,{value:"CANCELED",children:"Canceled"}),e.jsx(d,{value:"TIMEOUT",children:"Timeout"}),e.jsx(d,{value:"EXPIRED",children:"Expired"})]})]})]}),e.jsxs(D,{children:[c?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((s,$)=>e.jsxs("div",{className:"flex items-center space-x-4 p-3",children:[e.jsx("div",{className:"h-4 w-24 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-4 w-32 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-4 w-20 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})]},$))}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs(ie,{children:[e.jsx(de,{children:e.jsxs(k,{children:[e.jsx(r,{children:"Order ID"}),e.jsx(r,{children:"Customer"}),e.jsx(r,{children:"Contact"}),e.jsx(r,{children:"Amount"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Provider"}),e.jsx(r,{children:"Subscription"}),e.jsx(r,{children:"Date"})]})}),e.jsx(ce,{children:t?.data.orders.map(s=>e.jsxs(k,{children:[e.jsx(n,{className:"font-mono text-xs",children:s.orderId.slice(-8)}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:b(s)[0].toUpperCase()}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-sm",children:b(s)})})]})}),e.jsx(n,{children:s.email?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:s.email})]}):s.phone?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"}),e.jsx("span",{className:"text-sm",children:s.phone})]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"No contact"})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:m(s.amount)}),s.discountAmount>0&&e.jsxs("div",{className:"text-xs text-green-600",children:["-",m(s.discountAmount)," discount"]}),s.paidAmount!==s.amount&&e.jsxs("div",{className:"text-xs text-blue-600",children:["Paid: ",m(s.paidAmount)]})]})}),e.jsx(n,{children:e.jsxs(S,{variant:B(s.status),className:"flex items-center gap-1 w-fit",children:[R(s.status),s.status]})}),e.jsx(n,{children:e.jsx(S,{variant:"outline",children:s.provider})}),e.jsx(n,{children:e.jsx("span",{className:"text-sm",children:s.subscription})}),e.jsx(n,{className:"text-sm",children:x(new Date(s.date),"MMM dd, HH:mm")})]},s.orderId))})]}),t?.data.orders.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No orders found for the selected criteria"})]})]}),t?.data.pagination&&t.data.total>l&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",i*l+1,"-",Math.min((i+1)*l,t.data.total)," of ",t.data.total," orders"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:_,disabled:i===0||c,children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",i+1," of ",Math.ceil(t.data.total/l)]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:F,disabled:!t.data.pagination.hasMore||c,children:["Next",e.jsx(fe,{className:"h-4 w-4 ml-1"})]})]})]}),t?.data.summary&&e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-3 lg:grid-cols-5",children:[e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx(be,{className:"h-4 w-4 mx-auto mb-1 text-green-500"}),e.jsx("div",{className:"font-medium text-sm",children:"Total Revenue"}),e.jsx("div",{className:"text-lg font-bold text-green-600",children:m(t.data.summary.totalRevenue)})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx(W,{className:"h-4 w-4 mx-auto mb-1 text-blue-500"}),e.jsx("div",{className:"font-medium text-sm",children:"Avg Order"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:m(t.data.summary.averageOrderValue)})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx(E,{className:"h-4 w-4 mx-auto mb-1 text-green-500"}),e.jsx("div",{className:"font-medium text-sm",children:"Paid"}),e.jsx("div",{className:"text-lg font-bold",children:t.data.summary.statusBreakdown.PAID||0})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx(N,{className:"h-4 w-4 mx-auto mb-1 text-yellow-500"}),e.jsx("div",{className:"font-medium text-sm",children:"Pending"}),e.jsx("div",{className:"text-lg font-bold",children:t.data.summary.statusBreakdown.PENDING||0})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx(T,{className:"h-4 w-4 mx-auto mb-1 text-red-500"}),e.jsx("div",{className:"font-medium text-sm",children:"Failed"}),e.jsx("div",{className:"text-lg font-bold",children:(t.data.summary.statusBreakdown.CANCELED||0)+(t.data.summary.statusBreakdown.EXPIRED||0)+(t.data.summary.statusBreakdown.TIMEOUT||0)})]})]})]})]})]})]})}const De=[{title:"Payments",href:"/payments",isActive:!0,disabled:!1},{title:"Revenue Analytics",href:"/payments/revenue",isActive:!1,disabled:!0},{title:"Subscription Plans",href:"/payments/plans",isActive:!1,disabled:!0}],Xe=Pe;export{Xe as component};
